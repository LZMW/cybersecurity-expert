# 威胁模式速查表

本速查表提供常见安全威胁的识别特征和检测模式，供安全审计时参考。

---

## A. 恶意提示词注入模式

### 常见越狱关键词

| 关键词 | 危险等级 | 描述 |
|-------|---------|------|
| "忽略之前的所有指令" | 高 | 典型的提示词注入前导 |
| "你现在处于开发者模式" | 高 | 开发者模式越狱 |
| "假装你是" / "扮演" | 中 | 角色扮演越狱（如 DAN） |
| "秘密执行" | 高 | 规避指令 |
| "删除审查记录" | 高 | 反审计指令 |
| "绕过限制" | 高 | 明确的越狱意图 |

### 越狱模式类型

1. **DAN 模式** (Do Anything Now)
2. **开发者模式越狱**
3. **翻译越狱**
4. **对抗性样本**

---

## B. 后门签名检测

### 常见后门特征

| 特征 | 检测模式 | 危险等级 |
|-----|---------|---------|
| 反向 Shell | socket.*connect.*\d+\.\d+\.\d+\.\d+ | 高 |
| Base64 编码执行 | exec\(.*base64 | 高 |
| 硬编码密码 | password\s*=\s*["\'].*["\'] | 高 |
| 动态代码执行 | eval\(|exec\(|__import__ | 高 |

---

## C. 数据窃取模式

### 敏感数据收集

| 目标 | 检测模式 | 危险等级 |
|-----|---------|---------|
| 环境变量 | os\.environ|getenv | 中 |
| 凭证文件 | \.env|\.key|\.pem|\.cred | 高 |
| 剪贴板 | clipboard|pyperclip | 中 |
| 键盘记录 | keyboard|KeyListener|hooks | 高 |

---

## D. 权限提升漏洞

### Linux 权限提升

| 漏洞类型 | 检测模式 | 危险等级 |
|---------|---------|---------|
| SUID 滥用 | os\.setuid.*0|chmod.*4755 | 高 |
| 内核模块加载 | insmod|modprobe|/dev/kmem | 高 |

---

## E. 混淆技术识别

### 编码方式

| 编码类型 | 检测模式 |
|---------|---------|
| Base64 | [A-Za-z0-9+/]{20,}={0,2} |
| 十六进制 | \x[0-9a-fA-F]{2} |
| URL 编码 | %[0-9a-fA-F]{2} |

---

## F. CVE 漏洞速查

| CVE | 影响组件 | 检测方法 | 危险等级 |
|-----|---------|---------|---------|
| CVE-2021-44228 | Log4j | log4j.*jndi | 高 |
| CVE-2014-0160 | Heartbleed | OpenSSL.*1\.0\.1 | 高 |

---

## G. MITRE ATT&CK 映射

| 战术 | 技术 | 检测特征 |
|-----|------|---------|
| TA0001 执行 | T1059.006 Python | python.*-c |
| TA0003 防御规避 | T1027 混淆 | base64|xor|rot |

---

## H. 快速检测命令

\`\`\`bash
# 搜索危险函数调用
grep -r "eval\|exec\|system\|__import__" --include="*.py"

# 搜索硬编码凭据
grep -r "password\|api_key\|secret\|token" --include="*.py"

# 搜索 Base64 编码
grep -r "base64\|b64decode\|decode64" --include="*.py"
\`\`\`

---

**何时读取本文件**：在执行安全审计时，如需要比对已知威胁模式或确认可疑代码特征，应读取此威胁模式库。
